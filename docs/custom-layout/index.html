<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-alpha.72">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Litho Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Litho Blog Atom Feed">
<link rel="preconnect" href="https://www.google-analytics.com">
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-44373548-28","auto"),ga("send","pageview")</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>
<link rel="search" type="application/opensearchdescription+xml" title="Litho" href="/opensearch.xml"><title data-react-helmet="true">Custom Layout | Litho</title><meta data-react-helmet="true" property="og:url" content="https://fblitho.com/docs/custom-layout"><meta data-react-helmet="true" name="docsearch:language" content="en"><meta data-react-helmet="true" name="docsearch:version" content="current"><meta data-react-helmet="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Custom Layout | Litho"><meta data-react-helmet="true" name="description" content="Litho relies on Yoga, a powerful layout engine that is able to create very complex UIs, for layout calculations.  However, there are few exceptions where Yoga is not enough and you may need to implement your own measuring and layout."><meta data-react-helmet="true" property="og:description" content="Litho relies on Yoga, a powerful layout engine that is able to create very complex UIs, for layout calculations.  However, there are few exceptions where Yoga is not enough and you may need to implement your own measuring and layout."><link data-react-helmet="true" rel="shortcut icon" href="/images/favicon.png"><link data-react-helmet="true" rel="canonical" href="https://fblitho.com/docs/custom-layout"><link data-react-helmet="true" rel="alternate" href="https://fblitho.com/docs/custom-layout" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://fblitho.com/docs/custom-layout" hreflang="x-default"><link data-react-helmet="true" rel="preconnect" href="https://BH4D9OD16A-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.7ff81ca3.css">
<link rel="stylesheet" href="/assets/css/main.30634811.css">
<link rel="preload" href="/assets/js/styles.10ad285b.js" as="script">
<link rel="preload" href="/assets/js/runtime~main.efaf1af3.js" as="script">
<link rel="preload" href="/assets/js/main.fc619540.js" as="script">
<link rel="preload" href="/assets/js/1.bef55bbe.js" as="script">
<link rel="preload" href="/assets/js/2.9164bb93.js" as="script">
<link rel="preload" href="/assets/js/101.76b4e9ac.js" as="script">
<link rel="preload" href="/assets/js/104.2357c688.js" as="script">
<link rel="preload" href="/assets/js/935f2afb.a71184da.js" as="script">
<link rel="preload" href="/assets/js/17896441.41a43866.js" as="script">
<link rel="preload" href="/assets/js/af690422.976c0cba.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script>
<div style="display: none; text-align: center; background-color: white; color: black;" id="internaldocs-banner"></div><div id="__docusaurus">
<div><a href="#main" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle" type="button" tabindex="0"><svg aria-label="Menu" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><img src="/images/logo.svg" alt="Litho Logo" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/images/logo.svg" alt="Litho Logo" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><strong class="navbar__title">Litho</strong></a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/docs/intro/motivation">Docs</a><a href="/javadoc" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">API</a><a class="navbar__item navbar__link" href="/docs/tutorial/overview">Tutorial</a><a href="https://github.com/facebook/litho" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub</a><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span></button></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/"><img src="/images/logo.svg" alt="Litho Logo" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/images/logo.svg" alt="Litho Logo" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><strong class="navbar__title">Litho</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/intro/motivation">Docs</a></li><li class="menu__list-item"><a href="/javadoc" target="_blank" rel="noopener noreferrer" class="menu__link">API</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/tutorial/overview">Tutorial</a></li><li class="menu__list-item"><a href="https://github.com/facebook/litho" target="_blank" rel="noopener noreferrer" class="menu__link">GitHub</a></li></ul></div></div></div></nav><div class="main-wrapper main-docs-wrapper"><div class="docPage_31aa"><main class="docMainContainer_3ufF"><div class="container padding-vert--lg docItemWrapper_3FMP"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><header><h1 class="docTitle_3a4h">Custom Layout</h1></header><div class="markdown"><p>Litho relies on <a href="https://yogalayout.com/docs/" target="_blank" rel="noopener noreferrer">Yoga</a>, a powerful layout engine that is able to create very complex UIs, for layout calculations.  However, there are few exceptions where Yoga is not enough and you may need to implement your own measuring and layout.</p><p>Litho provides a custom layout API for accessing size information while the <a href="/javadoc/com/facebook/litho/ComponentTree.html" target="_blank" rel="noopener noreferrer"><code>ComponentTree</code></a> is being created and measured, as well as the possibility to measure a component in isolation.</p><div class="admonition admonition-caution alert alert--warning"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>IMPORTANT</h5></div><div class="admonition-content"><p> This API comes with a <strong>non-negligible</strong> performance overhead. Therefore, it is advisable to only use it when it is absolutely necessary.</p></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="use-cases"></a>Use cases<a class="hash-link" href="#use-cases" title="Direct link to heading">#</a></h2><ul><li><p><strong>A component layout tree depends on its own and/or children&#x27;s size.</strong> For example, perhaps a component layout should use a child only if it fits within its size constraints. If the child doesn&#x27;t fit, the layout should instead use another child as a fallback.</p></li><li><p><strong>Children of a container have to be absolutely positioned manually based on their/parent size.</strong> Yoga can absolutely position children in a parent. However, the position itself might depend on the child sizes after being measured using the parent size constraints. Margins or paddings need to be manually taken into account if required.</p></li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="size-constraints"></a>Size constraints<a class="hash-link" href="#size-constraints" title="Direct link to heading">#</a></h2><p>Before diving into the API, you should be familiar with how the <a href="https://developer.android.com/reference/android/view/View.html#onMeasure(int,%20int)" target="_blank" rel="noopener noreferrer"><code>onMeasure</code></a> function works in a regular Android <code>View</code> and what a <a href="https://developer.android.com/reference/android/view/View.MeasureSpec.html" target="_blank" rel="noopener noreferrer"><code>MeasureSpec</code></a> is, since Litho uses an equivalent concept called <a href="/javadoc/com/facebook/litho/SizeSpec.html" target="_blank" rel="noopener noreferrer"><code>SizeSpec</code></a>.</p><p>Similar to the Android <code>MeasureSpec</code> equivalent, Litho&#x27;s <code>SizeSpec</code> is composed of a size and a mode. The possible modes, same as for <code>MeasureSpec</code>, are: <code>UNSPECIFIED</code>, <code>EXACTLY</code> and <code>AT_MOST</code>.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="measuring-a-component"></a>Measuring a component<a class="hash-link" href="#measuring-a-component" title="Direct link to heading">#</a></h2><p>A component can be measured in isolation for a given <code>SizeSpec</code>. A <code>Size</code> object, passed as argument, will be populated with the resulting size.</p><p>In the following example, a <code>Text</code> component is measured with unspecified <code>SizeSpec</code> implying a single line of text indefinitely long.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly java"><div tabindex="0" class="prism-code language-java codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">final Component&lt;Text&gt; textComponent = Text.create(c)</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    .textSizeSp(16)</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    .text(“Some text to measure.”)</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    .build();</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">final Size outputSize = new Size();</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">textComponent.measure(</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    c,</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    SizeSpec.makeSizeSpec(0, UNSPECIFIED),</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    SizeSpec.makeSizeSpec(0, UNSPECIFIED),</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    outputSize);</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">final int textComponentWidth = outputSize.width;</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">final int textComponentHeight = outputSize.height;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="sizespec-information-during-layout"></a>SizeSpec information during layout<a class="hash-link" href="#sizespec-information-during-layout" title="Direct link to heading">#</a></h2><p>During layout creation, the API can provide information about the <code>SizeSpecs</code> a component is going to be measured with. To access this information, the <a href="/javadoc/com/facebook/litho/annotations/OnCreateLayoutWithSizeSpec.html" target="_blank" rel="noopener noreferrer"><code>@OnCreateLayoutWithSizeSpec</code></a> annotation needs to be used instead of <code>@OnCreateLayout</code>. The arguments of the annotated method, besides the standard ComponentContext, are two more integers representing the width spec and the height spec.</p><p>In the following example, a <code>Text</code> component is measured to check if the given text fits in the available space. An <code>Image</code> component is otherwise used.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly java"><div tabindex="0" class="prism-code language-java codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">@LayoutSpec</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">class MyComponentSpec {</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  @OnCreateLayoutWithSizeSpec</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  static Component onCreateLayoutWithSizeSpec(ComponentContext c, int widthSpec, int heightSpec) {</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    final Component textComponent =</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">        Text.create(c).textSizeSp(16).text(&quot;Some text to measure.&quot;).build();</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    // UNSPECIFIED sizeSpecs will measure the text as being one line only,</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    // having unlimited width.</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    final Size textOutputSize = new Size();</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    textComponent.measure(</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">        c,</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">        SizeSpec.makeSizeSpec(0, UNSPECIFIED),</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">        SizeSpec.makeSizeSpec(0, UNSPECIFIED),</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">        textOutputSize);</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    // Small component to use in case textComponent doesn’t fit within</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    // the current layout.</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    final Component imageComponent = Image.create(c).drawableRes(R.drawable.ic_launcher).build();</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    // Assuming SizeSpec.getMode(widthSpec) == EXACTLY or AT_MOST.</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    final int layoutWidth = SizeSpec.getSize(widthSpec);</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    final boolean textFits = (textOutputSize.width &lt;= layoutWidth);</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    return textFits ? textComponent : imageComponent;</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  }</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="optimizing-oncreatelayoutwithsizespec"></a>Optimizing OnCreateLayoutWithSizeSpec<a class="hash-link" href="#optimizing-oncreatelayoutwithsizespec" title="Direct link to heading">#</a></h2><p><code>@CreateLayoutWithSizeSpec</code> can be called more than once in cases where Yoga calls measure.  If the previous layout can be used for the new size spec this call can be avoided. Implementing the <code>OnShouldCreateLayoutWithNewSizeSpec</code> allows the spec to specify when the previous layout can be reused.</p><p><a href="/javadoc/com/facebook/litho/annotations/OnShouldCreateLayoutWithNewSizeSpec.html" target="_blank" rel="noopener noreferrer"><code>@OnShouldCreateLayoutWithNewSizeSpec</code></a> indicates that the annotated method will be called when the component checks if it can use the previous layout with a new size spec. This is used in conjunction with <code>@OnCreateLayoutWithSizeSpec</code>. The annotated method must have the following signature:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly java"><div tabindex="0" class="prism-code language-java codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">@OnShouldCreateLayoutWithNewSizeSpec</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">static boolean onShouldCreateLayoutWithNewSizeSpec(</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    ComponentContext c,</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    int newWidthSpec,</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    int newHeightSpec, ...)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>The annotated method should return <code>true</code> if and only if the Layout Spec should create a new layout for the new size spec. If the method returns <code>false</code> then the Component will use the previous layout. In addition,  outputs can be set in <code>onCreateLayoutWithSizeSpec</code> which can be referenced in <code>onShouldCreateLayoutWithNewSizeSpec</code> method as follows:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly java"><div tabindex="0" class="prism-code language-java codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">@LayoutSpec</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">class MyComponentSpec {</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  @OnCreateLayoutWithSizeSpec</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  static Component onCreateLayoutWithSizeSpec(</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">      ComponentContext c,</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">      int widthSpec,</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">      int heightSpec,</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">      Output&lt;Integer&gt; textWidth,</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">      Output&lt;Boolean&gt; didItFit) {</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    final Component textComponent =</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">        Text.create(c).textSizeSp(16).text(&quot;Some text to measure.&quot;).build();</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    // UNSPECIFIED sizeSpecs will measure the text as being one line only,</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    // having unlimited width.</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    final Size textOutputSize = new Size();</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    textComponent.measure(</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">        c,</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">        SizeSpec.makeSizeSpec(0, UNSPECIFIED),</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">        SizeSpec.makeSizeSpec(0, UNSPECIFIED),</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">        textOutputSize);</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    // Small component to use in case textComponent doesn’t fit within</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    // the current layout.</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    final Component imageComponent = Image.create(c).drawableRes(R.drawable.ic_launcher).build();</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    // Assuming SizeSpec.getMode(widthSpec) == EXACTLY or AT_MOST.</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    final int layoutWidth = SizeSpec.getSize(widthSpec);</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    final boolean textFits = (textOutputSize.width &lt;= layoutWidth);</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    // set the outputs</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    textWidth.set(textOutputSize.width);</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    didItFit.set(textFits);</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    return textFits ? textComponent : imageComponent;</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  }</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  @OnShouldCreateLayoutWithNewSizeSpec</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  static boolean onShouldCreateLayoutWithNewSizeSpec(</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">      ComponentContext c,</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">      int newWidthSpec,</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">      int newHeightSpec,</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">      @FromPreviousCreateLayout int textWidth,</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">      @FromPreviousCreateLayout boolean didItFit) {</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    final int newLayoutWidth = SizeSpec.getSize(newWidthSpec);</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    final boolean doesItStillFit = (textWidth &lt;= newLayoutWidth);</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    // false if it still fits or if still doesn&#x27;t fit</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    return doesItStillFit ^ didItFit;</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  }</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><img src="/images/flow-chart-v0.22.1-layout-with-size-spec.svg" alt="Layout Spec lifecycle flowchart" class="white-background"></div></article><div class="margin-vert--xl"><div class="row"><div class="col"><a href="https://github.com/facebook/litho/edit/master/website/../docs/custom-layout.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" role="img" viewBox="0 0 40 40" class="iconEdit_2_ui" aria-label="Edit page"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Docs pages navigation"><div class="pagination-nav__item"></div><div class="pagination-nav__item pagination-nav__item--next"></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#use-cases" class="table-of-contents__link">Use cases</a></li><li><a href="#size-constraints" class="table-of-contents__link">Size constraints</a></li><li><a href="#measuring-a-component" class="table-of-contents__link">Measuring a component</a></li><li><a href="#sizespec-information-during-layout" class="table-of-contents__link">SizeSpec information during layout</a></li><li><a href="#optimizing-oncreatelayoutwithsizespec" class="table-of-contents__link">Optimizing OnCreateLayoutWithSizeSpec</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">Learn</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/docs/getting-started">Getting Started</a></li><li class="footer__item"><a href="/javadoc" target="_blank" rel="noopener noreferrer" class="footer__link-item">API</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Open Source</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/docs/contributing">How To Contribute</a></li><li class="footer__item"><a href="https://opensource.facebook.com" target="_blank" rel="noopener noreferrer" class="footer__link-item">Open Source Projects</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Legal</h4><ul class="footer__items"><li class="footer__item"><a href="https://opensource.facebook.com/legal/privacy" target="_blank" rel="noopener noreferrer" class="footer__link-item">Privacy</a></li><li class="footer__item"><a href="https://opensource.facebook.com/legal/terms" target="_blank" rel="noopener noreferrer" class="footer__link-item">Terms</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Social</h4><ul class="footer__items"><li class="footer__item"><a href="https://github.com/facebook/litho" target="_blank" rel="noopener noreferrer" class="footer__link-item">Github</a></li><li class="footer__item"><a href="https://twitter.com/fblitho" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter</a></li></ul></div></div><div class="footer__bottom text--center"><div class="margin-bottom--sm"><a href="https://opensource.facebook.com" target="_blank" rel="noopener noreferrer" class="footerLogoLink_MyFc"><img src="/images/oss_logo.png" alt="Facebook Open Source Logo" class="themedImage_1VuW themedImage--light_3UqQ footer__logo"><img src="/images/oss_logo.png" alt="Facebook Open Source Logo" class="themedImage_1VuW themedImage--dark_hz6m footer__logo"></a></div><div class="footer__copyright">Copyright © 2021 Facebook, Inc.</div></div></div></footer></div>
<script src="/assets/js/styles.10ad285b.js"></script>
<script src="/assets/js/runtime~main.efaf1af3.js"></script>
<script src="/assets/js/main.fc619540.js"></script>
<script src="/assets/js/1.bef55bbe.js"></script>
<script src="/assets/js/2.9164bb93.js"></script>
<script src="/assets/js/101.76b4e9ac.js"></script>
<script src="/assets/js/104.2357c688.js"></script>
<script src="/assets/js/935f2afb.a71184da.js"></script>
<script src="/assets/js/17896441.41a43866.js"></script>
<script src="/assets/js/af690422.976c0cba.js"></script>
</body>
</html>