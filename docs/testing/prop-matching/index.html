<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-alpha.72">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Litho Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Litho Blog Atom Feed">
<link rel="preconnect" href="https://www.google-analytics.com">
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-44373548-28","auto"),ga("send","pageview")</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>
<link rel="search" type="application/opensearchdescription+xml" title="Litho" href="/opensearch.xml"><title data-react-helmet="true">Matching @Prop | Litho</title><meta data-react-helmet="true" property="og:url" content="https://fblitho.com/docs/testing/prop-matching"><meta data-react-helmet="true" name="docsearch:language" content="en"><meta data-react-helmet="true" name="docsearch:version" content="current"><meta data-react-helmet="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Matching @Prop | Litho"><meta data-react-helmet="true" name="description" content="Checkout the getting started section to setup the test environment correctly."><meta data-react-helmet="true" property="og:description" content="Checkout the getting started section to setup the test environment correctly."><link data-react-helmet="true" rel="shortcut icon" href="/images/favicon.png"><link data-react-helmet="true" rel="canonical" href="https://fblitho.com/docs/testing/prop-matching"><link data-react-helmet="true" rel="alternate" href="https://fblitho.com/docs/testing/prop-matching" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://fblitho.com/docs/testing/prop-matching" hreflang="x-default"><link data-react-helmet="true" rel="preconnect" href="https://BH4D9OD16A-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.7ff81ca3.css">
<link rel="stylesheet" href="/assets/css/main.30634811.css">
<link rel="preload" href="/assets/js/styles.10ad285b.js" as="script">
<link rel="preload" href="/assets/js/runtime~main.efaf1af3.js" as="script">
<link rel="preload" href="/assets/js/main.fc619540.js" as="script">
<link rel="preload" href="/assets/js/1.bef55bbe.js" as="script">
<link rel="preload" href="/assets/js/2.9164bb93.js" as="script">
<link rel="preload" href="/assets/js/101.76b4e9ac.js" as="script">
<link rel="preload" href="/assets/js/104.2357c688.js" as="script">
<link rel="preload" href="/assets/js/935f2afb.a71184da.js" as="script">
<link rel="preload" href="/assets/js/17896441.41a43866.js" as="script">
<link rel="preload" href="/assets/js/4d3558a0.55c34bc8.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script>
<div style="display: none; text-align: center; background-color: white; color: black;" id="internaldocs-banner"></div><div id="__docusaurus">
<div><a href="#main" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle" type="button" tabindex="0"><svg aria-label="Menu" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><img src="/images/logo.svg" alt="Litho Logo" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/images/logo.svg" alt="Litho Logo" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><strong class="navbar__title">Litho</strong></a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/docs/intro/motivation">Docs</a><a href="/javadoc" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">API</a><a class="navbar__item navbar__link" href="/docs/tutorial/overview">Tutorial</a><a href="https://github.com/facebook/litho" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub</a><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span></button></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/"><img src="/images/logo.svg" alt="Litho Logo" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/images/logo.svg" alt="Litho Logo" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><strong class="navbar__title">Litho</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/intro/motivation">Docs</a></li><li class="menu__list-item"><a href="/javadoc" target="_blank" rel="noopener noreferrer" class="menu__link">API</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/tutorial/overview">Tutorial</a></li><li class="menu__list-item"><a href="https://github.com/facebook/litho" target="_blank" rel="noopener noreferrer" class="menu__link">GitHub</a></li></ul></div></div></div></nav><div class="main-wrapper main-docs-wrapper"><div class="docPage_31aa"><div class="docSidebarContainer_3Kbt" role="complementary"><div class="sidebar_15mo"><div class="menu menu--responsive thin-scrollbar menu_Bmed"><button aria-label="Open menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_fgN0" width="24" height="24" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">What is Litho?</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/intro/motivation">Motivation</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/intro/built-with-litho">Built with Litho</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Tutorial</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/tutorial/overview">Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/tutorial/project-setup">Setting up the project</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/tutorial/first-components">Components and Props</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/tutorial/adding-state">Adding State</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/tutorial/handling-events">Handling Events</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/tutorial/building-lists">Building Lists</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Main Concepts</a><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">UI Composition</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/mainconcepts/uicomposition/layout-specs">Layout Specs</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/mainconcepts/uicomposition/mount-specs">Mount Specs</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/mainconcepts/uicomposition/flexbox-yoga">Layout System with Flexbox</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Coordinating State and Actions</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/mainconcepts/coordinate-state-actions/state-overview">State Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/mainconcepts/coordinate-state-actions/hoisting-state">Hoisting State</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/mainconcepts/coordinate-state-actions/events">Events Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/mainconcepts/coordinate-state-actions/trigger-events">Triggering events with Handles</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/mainconcepts/coordinate-state-actions/treeprops">TreeProps</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/mainconcepts/coordinate-state-actions/componenttree">ComponentTree</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/mainconcepts/coordinate-state-actions/dynamic-props">Dynamic Props</a></li></ul></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Building lists</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/sections/start">Basics: DiffSection and GroupSection</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/sections/recycler-collection-component">Adding and adapting RecyclerCollection to your App</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/sections/best-practices">Best Practices and Performance</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/sections/hscrolls">Nested scrolling and measurement</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/sections/api-overview">API 📄: annotations, events and lifecycles</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/sections/working-ranges">Advanced: Prefetch and pagination</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/sections/services">Advanced: Granular Dependency Injection</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/sections/view-support">Advanced: Mixing with Android Views</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/sections/diff-sections">Advanced: Writing your own DiffSection</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/sections/architecture">Internal 🏗: Sections implementation architecture</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Widgets</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/widgets/builtin-widgets">Built-in widgets</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Developer Tools</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/devtools/android-studio-plugin">Android Studio Plugin</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/devtools/flipper-plugins">Flipper Plugins</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">Testing</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/testing/testing-overview">Introduction</a></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!" tabindex="0">Unit Tests</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/testing/unit-testing">Getting Started</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/testing/subcomponent-testing">Sub-Component Testing</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/docs/testing/prop-matching">Matching @Prop</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/testing/testing-treeprops">Matching @TreeProp</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/testing/injectprop-matching">Matching @InjectProp</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/testing/event-handler-testing">Event Handler Testing</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/testing/sections-testing">Testing Sections</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">UI Tests</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/testing/espresso-testing">End-to-End Tests</a></li></ul></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/testing/tests-in-android-studio">Testing in Android Studio</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Animations</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/animations/transition-basics">Animation basics</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/animations/transition-types">Types of Transitions</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/animations/transition-all-layout">Animating All Layout</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/animations/transition-choreography">Customizing Transitions</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/animations/transition-definitions">Advanced: More ways to define transitions</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/animations/transition-key-types">Advanced: Transitions key scoping</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Accessibility</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/accessibility/accessibility-overview">Overview</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Performance</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/performance/analysing-performance">Analysing Performance</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/performance/spotting-performance-regressions">Spotting Performance Regressions</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Best Practices</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/best-practices/immutability">Immutability</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/best-practices/props-vs-state">Props vs. State</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/best-practices/coding-style">Coding Style</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Deep Dive</a><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Reconciliation</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/deep-dive/reconciliation">Introduction</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/deep-dive/reconciliation/enabling-reconciliation">Enabling Reconciliation</a></li></ul></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/deep-dive/incremental-mount">Incremental Mount</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Contributing Documentation</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/contributing-documentation">Contributing to Documentation</a></li></ul></li></ul></div></div></div><main class="docMainContainer_3ufF"><div class="container padding-vert--lg docItemWrapper_3FMP"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><header><h1 class="docTitle_3a4h">Matching @Prop</h1></header><div class="markdown"><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</h5></div><div class="admonition-content"><p>Checkout the <a href="/docs/testing/unit-testing">getting started</a> section to setup the test environment correctly.</p></div></div><div class="admonition admonition-tip alert alert--success"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="16" viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</h5></div><div class="admonition-content"><p>Checkout the <a href="/docs/testing/subcomponent-testing"><strong>sub-component testing</strong></a> section before diving into
prop matching.</p></div></div><p>In this article, we will drill a bit deeper and explore TestSpecs as a way to test individual
props of those components, even if we don&#x27;t know all of them.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="complex-components"></a>Complex Components<a class="hash-link" href="#complex-components" title="Direct link to heading">#</a></h2><p>Composability is one of the big strengths Litho has to offer. It allows you to
encapsulate your logic in small components and compose them together
effortlessly into larger ones. But despite all good efforts, sometimes there is
no clear dividing line and your component may grow beyond its original scope.</p><p>Having more complex components shouldn&#x27;t prevent you from using them
confidently. That&#x27;s why we have a set of powerful APIs to test your components
no matter the size.</p><p>For this example, let&#x27;s consider this LayoutSpec:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly java"><div tabindex="0" class="prism-code language-java codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">@LayoutSpec</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">public class ComplexComponentSpec {</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  @OnCreateLayout</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  static Component onCreateLayout(</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">      ComponentContext c,</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">      @Prop StoryProps&lt;ComplexAttachment&gt; storyProps,</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">      @Prop ImageRequest imageRequest,</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">      @Prop DraweeController draweeController,</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">      @Prop String title,</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">      @Prop(resType = ResType.DIMEN_TEXT) int titleTextSize,</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">      @Prop int visiblePhotoCount,</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">      @Prop(optional = true) Artist favoriteArtist,</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">      @Prop(optional = true) boolean shouldHavePuppies) {</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    return Row.create(c).build();</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  }</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="testing-complex-components"></a>Testing complex components<a class="hash-link" href="#testing-complex-components" title="Direct link to heading">#</a></h3><p>When we look at the props of our <code>ComplexComponent</code>, we see a lot of opaque
objects that we may have trouble getting ahold of for our tests. <code>StoryProps</code>
might be something we obtain through some dependency injection mechanism. A
<code>DraweeController</code> is an implementation detail we shouldn&#x27;t have to worry about
for ensuring that the component tree has the right shape.</p><p>However, if you remember the <code>SubComponent.of</code> API, we need to specify all
non-optional props for it to succeed. Let&#x27;s see what this would look like:</p><img src="/images/complex-component-0.svg" align="right" width="200px" class="white-background"><br><p>As always, we create a standard JUnit test suite and run it with a
<code>RobolectricTestRunner</code>-compatible implementation like <code>LithoTestRunner</code>.</p><p>For the purpose of this article, we assume that we have a <code>FeedItemComponent</code>
that contains our <code>ComplexComponent</code>. The <code>FeedItemComponent</code> contains the logic
for populating our complex props which we want to verify.</p><br clear="right"><br><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly java"><div tabindex="0" class="prism-code language-java codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">@Test</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">public void testComplexSubComponent() {</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  final ComponentContext c = mLithoViewRule.getContext();</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  final Component&lt;FeedItemComponent&gt; component = makeComponent(&quot;Two Brothers&quot;);</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  assertThat(c, component)</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    .has(</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">      subComponentWith(</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">        c, legacySubComponent(SubComponent.of(</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">          // ERROR: This fails at runtime as we haven&#x27;t provided all</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">          // required parameters.</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">          ComplexComponent.create(c)</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">            .title(&quot;Two Brothers&quot;)</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">            .build()))));</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">}</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>Sadly, this test fails with this error message:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><div tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">java.lang.IllegalStateException: The following props are not marked as optional</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">and were not supplied: [storyProps, imageRequest, draweeController,</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">titleTextSize, visiblePhotoCount]</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>But what if we can&#x27;t provide these props in our tests? Or if we don&#x27;t
want to test implementation details like the image loading controller?</p><p>We could simply choose not to test any props at all and decide to verify only
the presence of our component.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly java"><div tabindex="0" class="prism-code language-java codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">@Test</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">public void testComplexSpecIsPresent() {</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  final ComponentContext c = mLithoViewRule.getContext();</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  final Component&lt;FeedItemComponent&gt; component = makeComponent(&quot;Rixty Minutes&quot;);</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  assertThat(c, component)</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    .has(</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">      subComponentWith(</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">        c, typeIs(ComplexComponent.class)));</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>Clearly, having this test is better than nothing. In the same way that
having some Starbucks coffee after a cross-Atlantic flight is better than no
coffee at all ... but I digress.</p><p>What if there was a way to match just <em>some</em> of our props?</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="props-matching-with-testspec"></a>Props Matching with <code>@TestSpec</code><a class="hash-link" href="#props-matching-with-testspec" title="Direct link to heading">#</a></h2><p>TestSpecs allow you to match against exactly those props that you choose to
test. Just as LayoutSpecs and MountSpecs, TestSpecs make use of the powerful
annotation processing mechanism Java offers and generate code for you.</p><p>We start by creating a new class as part of our testing project and link to the
original spec we want to generate our TestSpec for.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly java"><div tabindex="0" class="prism-code language-java codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">@TestSpec(ComplexComponentSpec.class)</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">public interface TestComplexComponentSpec {}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>There are a few things to note here:</p><ul><li>The class you reference in <code>@TestSpec</code> must be a LayoutSpec or MountSpec.</li><li>You must link to the Spec and not the generated component, e.g.
<code>ComplexComponentSpec.class</code> not <code>ComplexComponent.class</code>.</li><li>In contrast to other specs, TestSpecs are generated from an interface, not a
class.</li><li>The interface must be empty, i.e. cannot have any members.</li><li>By convention, you prefix your TestSpec with <code>Test</code>, followed by the original
spec name.</li></ul><p>And that&#x27;s it. Those two lines are enough to generate us a powerful matcher that
we can use in our tests.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="using-testspec"></a>Using <code>@TestSpec</code><a class="hash-link" href="#using-testspec" title="Direct link to heading">#</a></h3><p>Now that we have our TestSpec generated, let&#x27;s put it into use. Where normal
components have a <code>create</code> function, test specs come with a <code>matcher</code> function.
It does take the same props as the underlying component but, and this won&#x27;t come
as a surprise, allows omitting non-optional props.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly java"><div tabindex="0" class="prism-code language-java codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">@Test</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">public void testComplexTestSpecProps() {</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  final ComponentContext c = mLithoViewRule.getContext();</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  final Component&lt;FeedItemComponent&gt; component = makeComponent(&quot;Two Brothers&quot;);</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  assertThat(c, component)</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    .has(</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">      subComponentWith(</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">        c, TestComplexComponent.matcher(c)</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">          .shouldHavePuppies(false)</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">          .build()));</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>Obviously, this outrageous omission of puppies couldn&#x27;t possibly pass the test
run and will fail with a helpful error message:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><div tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">java.lang.AssertionError:</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">Expecting:</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"> &lt;FeedItemComponent{0, 0 - 100, 100}</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  ComplexComponent{0, 0 - 100, 0}</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  Column{0, 0 - 100, 50}</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    FeedImageComponent{0, 0 - 100, 50}</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">      RecyclerCollectionComponent{0, 0 - 100, 50}</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">        Recycler{0, 0 - 100, 0}</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    TitleComponent{4, 46 - 16, 46}</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">      Text{4, 46 - 16, 46 text=&quot;Some Name&quot;}</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    ActionsComponent{60, 4 - 96, 40}</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">      FavouriteButton{2, 2 - 34, 34 [clickable]}</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  FooterComponent{0, 50 - 100, 66}</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    Text{8, 8 - 92, 8 text=&quot;Two Brothers&quot;}&gt;</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">to have:</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"> &lt;sub component with &lt;Sub-component of type &lt;ComplexComponent&gt; with</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"> prop &lt;shouldHavePuppies&gt; is &lt;false&gt; (doesn&#x27;t match true)&gt;&gt;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>Here we can see a brief overview of the hierarchy we were matching against and
the matcher that failed.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="advanced-matchers"></a>Advanced Matchers<a class="hash-link" href="#advanced-matchers" title="Direct link to heading">#</a></h3><p>But wait, there&#x27;s more! Instead of just matching against partial props, you can
also provide hamcrest matchers in any place that accepts concrete values. For
props that take resource types, you can make use of all the same matchers you
find in regular components.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><div tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">@Test</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">public void testComplexTestSpecAdvancedProps() {</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  final ComponentContext c = mLithoViewRule.getContext();</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  final Component&lt;FeedItemComponent&gt; component =</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">      makeComponent(&quot;Rixty Minutes&quot;);</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  assertThat(c, component)</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    .has(</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">      subComponentWith(</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">        c, TestComplexComponent.matcher(c)</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">          // titleTextSizeDip, Sp etc. work too!</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">          .titleTextSizeRes(R.dimen.notification_subtext_size)</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">          .title(containsString(&quot;Minutes&quot;))</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">          .build()));</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="matching-matchers"></a>Matching Matchers<a class="hash-link" href="#matching-matchers" title="Direct link to heading">#</a></h3><p>There is one type of prop that requires some special treatment: components.
While we could just match against child components via normal equality (and
there is indeed support for this), it is not particularly helpful. We rarely
know what exact instance of a component is passed down to the props and we face
many of the same problems we discussed before: The props of the Component may
not be known in full or perhaps we don&#x27;t want to provide them all.</p><img src="/images/complex-component-0.svg" align="right" width="200px" class="white-background"><p>The solution to this is obvious: We match matchers! For any prop that takes a
Component, the TestSpec generates a matcher that takes another matcher. This
allows for <strong>declarative matching against entire trees of components</strong>.</p><p>For our example, let&#x27;s suppose that our <code>FeedItemComponent</code> wraps the
<code>ComplexComponent</code> in a <code>Card</code>.</p><br clear="right"><br><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly java"><div tabindex="0" class="prism-code language-java codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">@Test</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">public void testComplexTestSpecProps() {</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  final ComponentContext c = mLithoViewRule.getContext();</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  final Component&lt;FeedItemComponent&gt; component = makeComponent(&quot;Ricksy Business&quot;);</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  assertThat(c, component)</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    .has(</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">      subComponentWith(</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">        c, TestCard.matcher(c)</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">          .content(TestComplexComponent.matcher(c)</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">            .title(endsWith(&quot;Business&quot;))</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">            .build())</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">          .build()));</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>Notice the <code>TestCard</code> we use to declare our hierarchy here. The <code>litho-testing</code>
package comes with TestSpecs for all standard Litho widgets.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="a-note-on-buck"></a>A Note on Buck<a class="hash-link" href="#a-note-on-buck" title="Direct link to heading">#</a></h2><p>If you use gradle, this should Just Work™ and shouldn&#x27;t require any additional
setup.</p><p>With Buck or Blaze/Bazel, however, you may need some additional configuration
for the annotation processing step to work.</p><p>In order to save you copy-pasting boilerplate all over your project, it is
recommended keep a rule definition like this in a well-known place
(e.g. <code>//tools/build_defs/android/litho_testspec.bzl</code>). You would obviously have to adjust
the library paths to the corresponding targets in your code base.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly python"><div tabindex="0" class="prism-code language-python codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token triple-quoted-string string">&quot;&quot;&quot;Provides macros for working with litho testspec.&quot;&quot;&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token keyword" style="color:#e3116c">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(111, 66, 193)">litho_testspec</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  name</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  deps</span><span class="token operator" style="color:rgb(0, 92, 197)">=</span><span class="token boolean" style="color:rgb(0, 92, 197)">None</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  annotation_processors</span><span class="token operator" style="color:rgb(0, 92, 197)">=</span><span class="token boolean" style="color:rgb(0, 92, 197)">None</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  annotation_processor_deps</span><span class="token operator" style="color:rgb(0, 92, 197)">=</span><span class="token boolean" style="color:rgb(0, 92, 197)">None</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token operator" style="color:rgb(0, 92, 197)">**</span><span class="token plain">kwargs</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token punctuation" style="color:rgb(36, 41, 46)">:</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token triple-quoted-string string">&quot;&quot;&quot;Litho testspec.&quot;&quot;&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  deps </span><span class="token operator" style="color:rgb(0, 92, 197)">=</span><span class="token plain"> deps </span><span class="token keyword" style="color:#e3116c">or</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">[</span><span class="token punctuation" style="color:rgb(36, 41, 46)">]</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  annotation_processors </span><span class="token operator" style="color:rgb(0, 92, 197)">=</span><span class="token plain"> annotation_processors </span><span class="token keyword" style="color:#e3116c">or</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">[</span><span class="token punctuation" style="color:rgb(36, 41, 46)">]</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  annotation_processor_deps </span><span class="token operator" style="color:rgb(0, 92, 197)">=</span><span class="token plain"> annotation_processor_deps </span><span class="token keyword" style="color:#e3116c">or</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">[</span><span class="token punctuation" style="color:rgb(36, 41, 46)">]</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  deps</span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token plain">extend</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(36, 41, 46)">[</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">      </span><span class="token string">&quot;//java/com/facebook/litho:litho&quot;</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">      </span><span class="token string">&quot;//third-party/android/androidx:support-v4&quot;</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">      </span><span class="token string">&quot;//libraries/components/litho-testing/src/main/java/com/facebook/litho/testing:testing&quot;</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">      </span><span class="token string">&quot;//libraries/components/litho-testing/src/main/java/com/facebook/litho/testing/assertj:assertj&quot;</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">      </span><span class="token string">&quot;//third-party/java/jsr-305:jsr-305&quot;</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">      </span><span class="token string">&quot;//third-party/java/hamcrest:hamcrest&quot;</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">      </span><span class="token string">&quot;//third-party/java/hamcrest:hamcrest-library&quot;</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(36, 41, 46)">]</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  annotation_processor_deps</span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token plain">extend</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(36, 41, 46)">[</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">      </span><span class="token string">&quot;//libraries/components/litho-processor/src/main/java/com/facebook/litho/specmodels/processor:processor-lib&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(36, 41, 46)">]</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  annotation_processors</span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token plain">extend</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(36, 41, 46)">[</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">      </span><span class="token string">&quot;com.facebook.litho.specmodels.processor.testing.ComponentsTestingProcessor&quot;</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(36, 41, 46)">]</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token keyword" style="color:#e3116c">return</span><span class="token plain"> android_library</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    name</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    deps</span><span class="token operator" style="color:rgb(0, 92, 197)">=</span><span class="token plain">deps</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    annotation_processors</span><span class="token operator" style="color:rgb(0, 92, 197)">=</span><span class="token plain">annotation_processors</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    annotation_processor_deps</span><span class="token operator" style="color:rgb(0, 92, 197)">=</span><span class="token plain">annotation_processor_deps</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token operator" style="color:rgb(0, 92, 197)">**</span><span class="token plain">kwargs</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>In the definitions for your test suite, you can then create a separate target
for your test specs:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly python"><div tabindex="0" class="prism-code language-python codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">load</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token string">&quot;//buck_imports:litho_testspec.bzl&quot;</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"> </span><span class="token string">&quot;litho_testspec&quot;</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">litho_testspec</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  name </span><span class="token operator" style="color:rgb(0, 92, 197)">=</span><span class="token plain"> </span><span class="token string">&quot;testspecs&quot;</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  srcs </span><span class="token operator" style="color:rgb(0, 92, 197)">=</span><span class="token plain"> glob</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token punctuation" style="color:rgb(36, 41, 46)">[</span><span class="token string">&quot;*Spec.java&quot;</span><span class="token punctuation" style="color:rgb(36, 41, 46)">]</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  deps </span><span class="token operator" style="color:rgb(0, 92, 197)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">[</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token string">&quot;//my/library/dependencies&quot;</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token comment" style="color:rgb(106, 153, 85)"># ...</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(36, 41, 46)">]</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">robolectric_test</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  name </span><span class="token operator" style="color:rgb(0, 92, 197)">=</span><span class="token plain"> </span><span class="token string">&quot;test&quot;</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  srcs </span><span class="token operator" style="color:rgb(0, 92, 197)">=</span><span class="token plain"> glob</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token punctuation" style="color:rgb(36, 41, 46)">[</span><span class="token string">&quot;*Test.java*&quot;</span><span class="token punctuation" style="color:rgb(36, 41, 46)">]</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  deps </span><span class="token operator" style="color:rgb(0, 92, 197)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">[</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token string">&quot;:testspecs&quot;</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token comment" style="color:rgb(106, 153, 85)"># ...</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(36, 41, 46)">]</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>This ensures that test specs are processed by the dedicated
<code>ComponentsTestingProcessor</code>.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="tldr"></a>TL;DR<a class="hash-link" href="#tldr" title="Direct link to heading">#</a></h2><p><strong>Step 1</strong></p><p>Create a TestSpec for your LayoutSpec or MountSpec.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly java"><div tabindex="0" class="prism-code language-java codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">@TestSpec(MyLayoutSpec.class)</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">public interface TestMyLayoutSpec {}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p><strong>Step 2</strong></p><p>Use the generated test matcher in your suite.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly java"><div tabindex="0" class="prism-code language-java codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">@Test</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">public void testComplexTestSpecAdvancedProps() {</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  final ComponentContext c = mLithoViewRule.getContext();</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  final Component&lt;MyWrapperComponent&gt; component = ...;</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  assertThat(c, component)</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    .has(</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">      subComponentWith(</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">        c, TestMyLayout.matcher(c)</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">          .titleTextSizeRes(R.dimen.notification_subtext_size)</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">          .title(containsString(&quot;Minutes&quot;))</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">          .child(TestChildComponent.matcher(c).size(greaterThan(5)).build())</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">          .build()));</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div></div></article><div class="margin-vert--xl"><div class="row"><div class="col"><a href="https://github.com/facebook/litho/edit/master/website/../docs/testing/prop-matching.mdx" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" role="img" viewBox="0 0 40 40" class="iconEdit_2_ui" aria-label="Edit page"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/testing/subcomponent-testing"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">« Sub-Component Testing</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/testing/testing-treeprops"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Matching @TreeProp »</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#complex-components" class="table-of-contents__link">Complex Components</a><ul><li><a href="#testing-complex-components" class="table-of-contents__link">Testing complex components</a></li></ul></li><li><a href="#props-matching-with-testspec" class="table-of-contents__link">Props Matching with <code>@TestSpec</code></a><ul><li><a href="#using-testspec" class="table-of-contents__link">Using <code>@TestSpec</code></a></li><li><a href="#advanced-matchers" class="table-of-contents__link">Advanced Matchers</a></li><li><a href="#matching-matchers" class="table-of-contents__link">Matching Matchers</a></li></ul></li><li><a href="#a-note-on-buck" class="table-of-contents__link">A Note on Buck</a></li><li><a href="#tldr" class="table-of-contents__link">TL;DR</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">Learn</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/docs/getting-started">Getting Started</a></li><li class="footer__item"><a href="/javadoc" target="_blank" rel="noopener noreferrer" class="footer__link-item">API</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Open Source</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/docs/contributing">How To Contribute</a></li><li class="footer__item"><a href="https://opensource.facebook.com" target="_blank" rel="noopener noreferrer" class="footer__link-item">Open Source Projects</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Legal</h4><ul class="footer__items"><li class="footer__item"><a href="https://opensource.facebook.com/legal/privacy" target="_blank" rel="noopener noreferrer" class="footer__link-item">Privacy</a></li><li class="footer__item"><a href="https://opensource.facebook.com/legal/terms" target="_blank" rel="noopener noreferrer" class="footer__link-item">Terms</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Social</h4><ul class="footer__items"><li class="footer__item"><a href="https://github.com/facebook/litho" target="_blank" rel="noopener noreferrer" class="footer__link-item">Github</a></li><li class="footer__item"><a href="https://twitter.com/fblitho" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter</a></li></ul></div></div><div class="footer__bottom text--center"><div class="margin-bottom--sm"><a href="https://opensource.facebook.com" target="_blank" rel="noopener noreferrer" class="footerLogoLink_MyFc"><img src="/images/oss_logo.png" alt="Facebook Open Source Logo" class="themedImage_1VuW themedImage--light_3UqQ footer__logo"><img src="/images/oss_logo.png" alt="Facebook Open Source Logo" class="themedImage_1VuW themedImage--dark_hz6m footer__logo"></a></div><div class="footer__copyright">Copyright © 2021 Facebook, Inc.</div></div></div></footer></div>
<script src="/assets/js/styles.10ad285b.js"></script>
<script src="/assets/js/runtime~main.efaf1af3.js"></script>
<script src="/assets/js/main.fc619540.js"></script>
<script src="/assets/js/1.bef55bbe.js"></script>
<script src="/assets/js/2.9164bb93.js"></script>
<script src="/assets/js/101.76b4e9ac.js"></script>
<script src="/assets/js/104.2357c688.js"></script>
<script src="/assets/js/935f2afb.a71184da.js"></script>
<script src="/assets/js/17896441.41a43866.js"></script>
<script src="/assets/js/4d3558a0.55c34bc8.js"></script>
</body>
</html>